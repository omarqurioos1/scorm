var a=class e{static log(r,...o){console.log(r,...o)}static warn(r,...o){console.warn(r,...o)}static error(r,...o){console.error(r,...o)}static assert(r,o){r||e.error("Assertion failed"+(o?": "+o:""))}};function x(e,r){return a.assert(e,r),e}function u(e){return e!==void 0}function mr(e){let r=typeof e;return r=="object"&&e!=null||r=="function"}function $(e){return typeof e=="function"}function q(e){return e===null}function fr(e,r,o){return function(...t){o&&o(...t);let p=e(...t);return r(this,p,...t),p}}var _=Function("return this")(),Dr=()=>!0;function R(e,r){if(Dr()){if(r){a.error(e);return}a.warn(e)}}function X(e,r){let o=e.stack||e.toString();String(o).indexOf(e.message)<0&&R(e.message,r),R(o,r)}var br=Object.getPrototypeOf({});function Y(e){e&&(x(!e.disposed),!1&&setTimeout(()=>{let r=e.owner?e.owner.constructor.name:null,o=e.owner?e.ownerPropertyName():null;if(e.owner=null,e.ownerPropertyName=null,e instanceof g){let m=r?`[${r}].${o} have active signals`:void 0;x(e.handlersCount()==0,m)}let t=e,p=new Set;for(;(t=x(Object.getPrototypeOf(t)))!=br;)Object.getOwnPropertyNames(t).forEach(m=>{m!="constructor"&&p.add(m)});p.forEach(m=>{$(e[m])&&(e[m]=fr(e[m].bind(e),()=>{R(`using method ${m} from disposed object ${e.constructor.name}`,!0)}))})},100),$(e.dispose)&&e.dispose(),e.disposed=!0)}function nr(e,r){let o=e.split("."),t=_;!(o[0]in t)&&typeof t.execScript!="undefined"&&t.execScript("var "+o[0]);for(let p;o.length&&(p=o.shift());)!o.length&&u(r)?t[p]=r:t[p]&&t[p]!==Object.prototype[p]?t=t[p]:t=t[p]={}}!1||(_.onerror=function(...e){let[r,,,,o]=e;return o?X(o,!0):R(r,!0),!0});var Ur=0,O=class{constructor(r,o,t,p,m=null){this.listener=r,this.src=o,this.type=t,this.capture=!!p,this.handler=m,this.key=++Ur}};var w=class extends O{constructor(r,o,t,p,m,f){super(r,t,p,m,f),this.proxy=o,this.callOnce=!1,this.removed=!1}markAsRemoved(){this.removed=!0,this.listener=null,this.proxy=null,this.src=null,this.handler=null}};function ir(e,r,o){for(let t in e)if(r.call(o,e[t],t,e))return!0;return!1}function sr(e,r,o){if(e){for(let t in e)if(r.call(o,e[t],t,e))return t}}function xr(e,r){for(let o in e)if(!(o in r)||e[o]!==r[o])return!1;for(let o in r)if(!(o in e))return!1;return!0}function ar(e,r,o){let t={};if(e)for(let p in e)r.call(o,e[p],p,e)&&(t[p]=e[p]);return t}var P=class{constructor(r){this.src=r,this.listeners={},this._typeCount=0}getTypeCount(){return this._typeCount}getListenerCount(){let r=0;for(let o of Object.keys(this.listeners))r+=this.listeners[o].length;return r}add(r,o,t,p,m){let f=r.toString(),i=this.listeners[f];i||(i=this.listeners[f]=[],this._typeCount++);let n,s=this._findListenerIndex(i,o,p,m);return s>-1?(n=i[s],t||(n.callOnce=!1)):(n=new w(o,null,this.src,f,!!p,m),n.callOnce=t,i.push(n)),n}remove(r,o,t,p){let m=r.toString();if(!(m in this.listeners))return!1;let f=this.listeners[m],i=this._findListenerIndex(f,o,t,p);return i>-1?(f[i].markAsRemoved(),f.splice(i,1),f.length==0&&(delete this.listeners[m],this._typeCount--),!0):!1}removeByKey(r){let o=r.type;if(!(o in this.listeners))return!1;let t=this.listeners[o],p=t.indexOf(r),m=p>=0;return m&&(t.splice(p,1),r.markAsRemoved(),this.listeners[o].length==0&&(delete this.listeners[o],--this._typeCount)),m}getListeners(r,o){let t=this.listeners[r.toString()],p=[];if(t)for(let m=0;m<t.length;++m){let f=t[m];f.capture==o&&p.push(f)}return p}getListener(r,o,t,p){let m=this.listeners[r.toString()],f=-1;return m&&(f=this._findListenerIndex(m,o,t,p)),f>-1?m[f]:null}hasListener(r="",o){let t=u(r),p=t?r.toString():"",m=u(o);return ir(this.listeners,f=>{for(let i=0;i<f.length;++i)if((!t||f[i].type==p)&&(!m||f[i].capture==o))return!0;return!1})}_findListenerIndex(r,o,t,p){for(let m=0;m<r.length;++m){let f=r[m];if(!f.removed&&f.listener==o&&f.capture==!!t&&f.handler==p)return m}return-1}};var Z="ispring_lm_"+(Math.random()*1e6|0),J;function Mr(){if(!_.addEventListener||!Object.defineProperty)return!1;let e=!1,r=Object.defineProperty({},"passive",{get:function(){e=!0}});return _.addEventListener("test",Function.prototype,r),_.removeEventListener("test",Function.prototype,r),e}function Fr(){return u(J)||(J=Mr()),J}function j(e){let r=e[Z];return r instanceof P?r:null}function y(e){let r=e;if(!r||r.removed)return!1;let o=r.src,t=r.type,p=r.proxy;o.removeEventListener&&o.removeEventListener(t,p,r.capture);let m=j(o);return m?(m.removeByKey(r),m.getTypeCount()==0&&(o[Z]=null)):r.markAsRemoved(),!0}function Nr(e){let{listener:r,handler:o,callOnce:t}=e,p=o?r.bind(o):r;return t?(...m)=>{p(...m),y(e)}:p}function E(e,r,o,t,p=null){let m=mr(t)?x(t).capture:!!t,f=j(e);f||(f=new P(e),e[Z]=f);let i=!!(t&&t.once),n=f.add(r,o,i,m,p);if(n.proxy)return n;let s=Nr(n);if(n.proxy=s,e.addEventListener){let l=Fr()?t:m;u(l)||(l=!1),e.addEventListener(r.toString(),s,l)}else throw new Error("addEventListener is unavailable.");return n}function lr(e,r,o,t,p){t=!!t;let m=j(e);return m?m.getListener(r,o,t,p):null}var D=class{dispose(){}};var Vr=0,b=class extends D{constructor(){super(),this._listenersKeys=null,this._activeSignals=null,this._disposables=null,this._customDestructHandlers=null}addDestructHandler(r){this._customDestructHandlers=this._customDestructHandlers||[],this._customDestructHandlers.push(r)}dispose(){if(this._destruct(),this._customDestructHandlers)for(let r of this._customDestructHandlers)r();if(this._disposables)for(let r of this._disposables)Y(r);if(this._listenersKeys){for(let r of this._listenersKeys)y(r);this._listenersKeys=null}if(this._activeSignals)for(let r of Object.keys(this._activeSignals))this._removeSignalByKey(r)}_listen(r,o,t,p){this._listenersKeys=this._listenersKeys||[];let m=E(this._getEventTarget(r),o,t,p,this);return this._listenersKeys.push(m),m}_unlisten(r,o,t){let p=lr(this._getEventTarget(r),o,t,!1);return!!p&&this._unlistenByKey(p)}_unlistenByKey(r){let o=x(this._listenersKeys),t=o.indexOf(r);return t>=0&&o.splice(t,1),y(r)}_addSignal(r,o,t){this._activeSignals=this._activeSignals||{},r.add(o,this,t);let p=++Vr;return this._activeSignals[p]={dispatcher:r,fn:o,priority:t},p}_addSignalCallOnce(r,o,t){let p=(...m)=>{o.apply(this,m),this._removeSignal(r,p,t)};this._addSignal(r,p,t)}_removeSignal(r,o,t){let p=sr(this._activeSignals,m=>xr(m,{dispatcher:r,fn:o,priority:t}));p?this._removeSignalByKey(p):!1&&a.warn("unknown signal")}_removeSignalByKey(r){if(!(this._activeSignals&&this._activeSignals[r])){a.warn("unknown signal key");return}let{dispatcher:o,fn:t,priority:p}=this._activeSignals[r];o.remove(t,this,p),delete this._activeSignals[r]}_removeAllEvents(r){if(r){if(this._activeSignals){let o=ar(this._activeSignals,t=>t.dispatcher.eventOwner()==r);for(let t of Object.keys(o))this._removeSignalByKey(t)}if(this._listenersKeys){let o=this._getEventTarget(r),t=this._listenersKeys.filter(p=>p.src==o);for(let p of t)this._unlistenByKey(p)}}}_name(){let r=this,o=r.owner,t=`[${this.constructor.name}]`;return o&&(t+=` in [${o.constructor.name}].${r.ownerPropertyName()}`),t}_addDisposable(r){if(this._disposables=this._disposables||[],!r||this._disposables.includes(r))return r;if(!1){let o=r;x(this._disposables.indexOf(r)<0),x(!o.owner),o.owner=this,o.ownerPropertyName=()=>{let t=this;for(let p of Object.keys(t))if(t[p]==o)return p;return"unknown"}}return this._disposables.push(r),r}_removeDisposable(...r){if(this._disposables){for(let o of r)if(o){this._cleanItemDependencies(o);let t=this._disposables.indexOf(o);t>=0&&(this._disposables.splice(t,1),Y(o))}}}_cleanItemDependencies(r){this._removeAllEvents(r)}_cleanDependencies(...r){for(let o of r)o&&this._cleanItemDependencies(o)}_getEventTarget(r){return r}_destruct(){}};function kr(e,r){return e>r?1:e<r?-1:0}function cr(e,r){if(!e)return!1;let o=e.indexOf(r),t=o>=0;return t&&e.splice(o,1),t}function Br(e,r,o,t,p){let m=0,f=e.length,i;for(;m<f;){let n=m+f>>1,s;o?s=r.call(p,e[n],n,e):s=r(t,e[n]),s>0?m=n+1:(f=n,i=!s)}return i?m:~m}function zr(e,r,o=kr){return Br(e,o,!1,r)}function ur(e,r,o){let t=zr(e,r,o);return t<0?(e.splice(-(t+1),0,r),!0):!1}var U=class{constructor(){this._priorities=null,this._values=null,this._zeroPriorityValues=null}push(r,o){this._addPriority(o);let t=this._getPriorityValues(o);t?t.push(r):a.warn("Priority array values are zero")}remove(r,o){let t=this._getPriorityValues(o);t&&cr(t,r)}removeAt(r,o){let t=this._getPriorityValues(o);t&&t.splice(r,1)}getValuesWithPriority(r){if(r==0)return this._zeroPriorityValues||[];if(!this._values)return a.warn("Priority array values are zero"),[];if(!(r in this._values))return[];let o=this._getPriorityValues(r);return o||(a.warn("Priority array values are zero"),[])}getAllValues(){if(!this._values)return this._zeroPriorityValues?this._zeroPriorityValues.slice():[];let r=[],o=x(this._priorities);for(let t=0;t<o.length;++t){let p=o[t],m=this._getPriorityValues(p);m&&r.push(...m)}return r}_addPriority(r){if(r==0){this._zeroPriorityValues=this._zeroPriorityValues||[];return}this._priorities=this._priorities||[0],this._values=this._values||{},r in this._values||(this._values[r]=[],ur(this._priorities,r))}_getPriorityValues(r){return r==0?this._zeroPriorityValues:x(this._values)[r]}};var g=class extends b{constructor(r=null){super(),this._handlers=null,this._owner=r}eventOwner(){return this._owner}add(r,o,t=0){this._handlers=this._handlers||new U,this._handlers.push({fn:r,context:o},t)}addCallOnce(r,o,t=0){let p=m=>{r.call(o,m),this.remove(p,o,t)};this.add(p,o,t)}remove(r,o,t=0){if(!this._handlers){a.warn("Signal has no handlers!");return}let p=this._handlers.getValuesWithPriority(t),m=p.length;for(let f=0;f<m;++f){let i=p[f];if(i.fn==r&&i.context==o){this._handlers.removeAt(f,t);break}}}has(r,o,t=0){if(!this._handlers)return!1;let p=this._handlers.getValuesWithPriority(t),m=p.length;for(let f=0;f<m;++f){let i=p[f];if(i.fn==r&&i.context==o)return!0}return!1}dispatch(r){if(!this._handlers)return;let o=this._handlers.getAllValues(),t=o.length;for(let p=0;p<t;++p){let m=o[p];if(this._handlers.getAllValues().indexOf(m)!=-1)if(!1)m.fn.apply(m.context,[r]);else try{m.fn.apply(m.context,[r])}catch(f){X(f,!0)}}}toFn(){return r=>this.dispatch(r)}handlersCount(){return this._handlers?this._handlers.getAllValues().length:0}};function M(e,r,o=!0){if(o)return parseFloat(e.toFixed(r))+"";let t=Math.pow(10,r);return Math.floor(e*t)/t+""}function rr(e){throw new Error(e)}function or(e){return e!==void 0}function Hr(e){return e===void 0}function Kr(e){return e===null}function dr(e){return Hr(e)||Kr(e)}function hr(e,r="assert failed"){e||rr(r)}function gr(e,r="verify failed"){return dr(e)&&rr(r),e}function _r({type:e,edge:r,fn:o,timeout:t}){let p,m;hr(!(e==="debounce"&&r==="leading"));function f(l){or(p)&&(clearTimeout(p),p=void 0),l&&(p=setTimeout(l,t))}function i(){if(!m)return;let l;try{l=o(...m.params),m.resolve(l)}catch(L){f(),gr(m).reject(L)}finally{m=void 0}return l}function n(){m==null||m.resolve(void 0),m=void 0}let s=(...l)=>{n();let L=or(p);if(!L||e==="debounce"){let v=()=>{f(m&&r==="leading"?v:void 0),i()};f(v)}return new Promise((v,wr)=>{m={params:l,resolve:v,reject:wr},r==="leading"&&!L&&i()})};return s.isPending=()=>!!m,s.flush=()=>(f(),i()),s.force=(...l)=>(s.cancel(),o(...l)),s.cancel=()=>{f(),n()},s}var er=(e,r,o="trailing")=>_r({type:"throttle",fn:e,timeout:r,edge:o});var tr={CLICK:"click",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",CHANGE:"change",SELECTION_CHANGE:"selectionchange",INPUT:"input",TEXT_INPUT:"textInput",KEY_DOWN:"keydown",KEY_PRESS:"keypress",PASTE:"paste",CUT:"cut",COPY:"copy",BLUR:"blur",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",LOAD:"load",LOAD_END:"loadend",LOADED_METADATA:"loadedmetadata",UNLOAD:"unload",BEFOREUNLOAD:"beforeunload",ERROR:"error",DRAG_START:"dragstart",DRAG_OVER:"dragover",DRAG_END:"dragend",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DROP:"drop",RESIZE:"resize",SCROLL:"scroll",COMPOSITIONSTART:"compositionstart",COMPOSITIONUPDATE:"compositionupdate",COMPOSITIONEND:"compositionend",ORIENTATIONCHANGE:"orientationchange",CUSTOM_CONNECTED:"connected",CUSTOM_DISCONNECTED:"disconnected",TRANSITIONEND:"transitionend",TOUCHSTART:"touchstart",VISIBILITYCHANGE:"visibilitychange"};var F=class{constructor(r){this._options=r}usePassedStatus(r){return!!(this._options&(r?2:1))}};function Sr(e){let r=Math.floor(e/3600),o=Math.floor(e%3600/60),t=Math.floor(e%60),p=e-Math.floor(e);return{h:r,m:o,s:t,ms:p}}function pr(e){return e<10?"0"+e:e}function N(e){let r=Sr(e);return"PT"+r.h+"H"+r.m+"M"+r.s+"S"}function T(e){let r=Sr(e);return pr(r.h)+":"+pr(r.m)+":"+pr(r.s)}function C(e){return e<10?"0"+e:e}function Pr(e){return typeof e=="number"&&(e=new Date(e)),e.getUTCFullYear()+"-"+C(e.getUTCMonth()+1)+"-"+C(e.getUTCDate())+"T"+C(e.getUTCHours())+":"+C(e.getUTCMinutes())+":"+C(e.getUTCSeconds())+".0Z"}function Er(e){let r=document.createElement("a");r.href="goodbye.html",r.click()}function d(){try{window==window.top?(window.open("","_self",""),window.close()):Er(window)}catch{Er(x(window.top))}}function Cr(e){return e.trim().replace(/[^\w-]/g,"_")}var Gr={id:"id",type:"type",score:"weighting",correctResponse:"correct_responses.%INDEX%.pattern",userResponse:"student_response",result:"result",duration:"latency",visitTime:"time"},Qr={id:"id",type:"type",score:"weighting",correctResponse:"correct_responses.%INDEX%.pattern",userResponse:"learner_response",description:"description",result:"result",duration:"latency",visitTime:"timestamp"},$r={};function Tr(e){return"cmi.interactions."+e+"."}function Ar(e){return parseInt(e.getValue("cmi.interactions._count"),10)}function Lr(e,r,o,t,p){if(p){let n=e.id+"_"+e.description,s=Cr(n.substr(0,255));o.setValue(r+t.id,s)}else o.setValue(r+t.id,e.id);o.setValue(r+t.type,e.type),o.setValue(r+t.score,e.score);let m=e.correctResponses||[];for(let n=0;n<m.length;++n){let s=t.correctResponse.replace("%INDEX%",String(n));o.setValue(r+s,m[n])}let f=e.userResponse;f!=null&&o.setValue(r+t.userResponse,f);function i(n){return p&&n==="incorrect"?"wrong":n}o.setValue(r+t.result,i(e.result))}function vr(e,r){let o=$r,t=e.id,p=-1;if(e.id in o?p=o[t]:(p=Ar(r),o[t]=p),p<0)return;let m=Tr(p),f=Gr;Lr(e,m,r,f,!0);let i=e.duration;i!=null&&r.setValue(m+f.duration,T(i/1e3));let n=e.visitTime;if(n!=null){let s=n.getHours()*3600+n.getMinutes()*60+n.getSeconds();r.setValue(m+f.visitTime,T(s))}}function Rr(e,r){let o=Ar(r);if(o<0)return;let t=Tr(o),p=Qr;Lr(e,t,r,p,!1),r.setValue(t+p.description,e.description);let m=e.duration;m!=null&&r.setValue(t+p.duration,N(m/1e3));let f=e.visitTime;f!=null&&r.setValue(t+p.visitTime,Pr(f))}var V={NORMAL:"normal",BROWSE:"browse",REVIEW:"review"};function Ir(e,r){try{for(let t=0;t<255;++t){if(e[r])return e[r];let p=e.parent;if(!p||e==p)break;e=p}}catch{}return null}function k(e,r){return Ir(e,r)||e.opener&&Ir(e.opener,r)}var B=class e{constructor(r,o){this._api=r,this._passed=!1,this._commitsCount=0,this._suspendEnabled=o}static create(r){let o=k(window,"API");return o?new e(o,r):null}initialize(){try{return this._toBool(this._api.LMSInitialize(""))}catch{}return!1}terminate(r){this.setValue("cmi.core.exit",r?this._getSuspendState():""),this.commit();try{return this._toBool(this._api.LMSFinish(""))}catch{}return!1}_getSuspendState(){return this._passed?"":"suspend"}commit(){this._commitsCount==0&&this.setValue("cmi.core.exit",this._suspendEnabled?this._getSuspendState():"");try{let r=this._toBool(this._api.LMSCommit(""));return this._commitsCount+=1,r}catch{}return!1}setPassed(r){this._passed=r}getValue(r){try{return this._api.LMSGetValue(r)}catch{}return""}setValue(r,o){typeof o=="number"&&(o=M(Number(o),2)+"");try{return this._toBool(this._api.LMSSetValue(r,o))}catch{}return!1}_toBool(r){return r=="true"}};var z=class{constructor(r){this._base=B.create(r),this._initialized=!1}initialize(){return this._initialized?!0:(this._initialized=this._base?this._base.initialize():!1,this._initialized)}initializeAsync(r,o){if(this._initialized){r();return}this._base?(this._initialized=this._base.initialize(),this._initialized?r():o()):(this._initialized=!1,o())}terminate(r){return this._base?this._base.terminate(r):!1}commit(){return this._base?this._base.commit():!1}getValue(r){return this._base?this._base.getValue(r):""}setValue(r,o){return this._base?this._base.setValue(r,o):!1}setScore(r,o,t,p){this.setValue("cmi.core.score.raw",r),this.setValue("cmi.core.score.min",o),this.setValue("cmi.core.score.max",t)}setProgress(r){}setSessionTime(r){this.setValue("cmi.core.session_time",T(r/1e3))}getSuspendedData(){return this.getValue("cmi.suspend_data")}getLaunchMode(){return V.NORMAL}setSuspendedData(r){this.setValue("cmi.suspend_data",r)}setStatus(r,o){q(r)?q(o)?this.setValue("cmi.core.lesson_status","unknown"):this.setValue("cmi.core.lesson_status",o?"completed":"incomplete"):this.setValue("cmi.core.lesson_status",r?"passed":"failed")}setPassed(r){x(this._base).setPassed(r)}addInteraction(r){vr(r,this)}getUserInfo(){return{id:this.getValue("cmi.core.student_id"),name:this.getValue("cmi.core.student_name"),email:""}}};var H={SECOND:"2",THIRD:"3",FOURTH:"4"};var K=class e{constructor(r,o,t){this._api=r,this._edition=o,this._passed=!1,this._commitsCount=0,this._suspendEnabled=t}static create(r,o){let t=k(window,"API_1484_11");return t?new e(t,r,o):null}initialize(){try{return this._toBool(this._api.Initialize(""))}catch{}return!1}terminate(r){this.setValue("cmi.exit",r?this._getSuspendState():"normal"),this.setValue("adl.nav.request","exitAll"),this.commit();try{return this._toBool(this._api.Terminate(""))}catch{}return!1}_getSuspendState(){return this._passed?"":"suspend"}commit(){this._commitsCount==0&&this.setValue("cmi.exit",this._suspendEnabled?this._getSuspendState():"normal");try{let r=this._toBool(this._api.Commit(""));return this._commitsCount+=1,r}catch{}return!1}getValue(r){try{return this._api.GetValue(r)}catch{}return""}setValue(r,o){typeof o=="number"&&(o=M(o,7));try{return this._toBool(this._api.SetValue(r,o))}catch{}return!1}setPassed(r){this._passed=r}getSuspendDataLimit(){return this._edition==H.SECOND?4e3:64e3}_toBool(r){return r=="true"}};var W=class{constructor(r,o){this._base=K.create(r,o),this._initialized=!1}initialize(){return this._initialized?!0:(this._initialized=this._base?this._base.initialize():!1,this._initialized)}initializeAsync(r,o){if(this._initialized){r();return}this._base?(this._initialized=this._base.initialize(),this._initialized?r():o()):(this._initialized=!1,o())}terminate(r){return this._base?this._base.terminate(r):!1}commit(){return this._base?this._base.commit():!1}getValue(r){return this._base?this._base.getValue(r):""}setValue(r,o){return this._base?this._base.setValue(r,o):!1}setScore(r,o,t,p=0){this.setValue("cmi.score.raw",r),this.setValue("cmi.score.min",o),this.setValue("cmi.score.max",t),this.setValue("cmi.score.scaled",p)}setProgress(r){this.setValue("cmi.progress_measure",r)}setSessionTime(r){this.setValue("cmi.session_time",N(r/1e3))}getSuspendedData(){return this.getValue("cmi.suspend_data")}setSuspendedData(r){if(!this._base)throw new Error;let o=this._base.getSuspendDataLimit();r.length<=o&&this.setValue("cmi.suspend_data",r)}getLaunchMode(){return this._base?this._base.getValue("cmi.mode"):V.NORMAL}setStatus(r,o){let t=(p,m,f,i)=>p===null?m:p?f:i;this.setValue("cmi.success_status",t(r,"unknown","passed","failed")),this.setValue("cmi.completion_status",t(o,"unknown","completed","incomplete"))}setPassed(r){this._base&&this._base.setPassed(r)}addInteraction(r){Rr(r,this)}getUserInfo(){return{id:this.getValue("cmi.learner_id"),name:this.getValue("cmi.learner_name"),email:""}}};function Or(){return{onSessionStart:new g,onSessionEnd:new g}}var qr=6e4;var h=class{constructor(r,o){this._apiVersion=r,this._config=o,this._active=!1,this._playerApi=null,this._suspendEnabled=!0,this._startTime=0,this._lmsApi=null,this._closeEventKeys=[],this._chaptersCompletionStatuses=[],this._longreadResult=null,this._longreadGraded=!1,this._sessionStateNotifier=Or(),this._commit=er(()=>{},0)}initializeLms(r){try{let o=new F(this._config.flags);this._lmsApi=this._createLmsApi(this._apiVersion,o,this._suspendEnabled),this._commit=er(this._lmsApi.commit.bind(this._lmsApi),qr)}catch(o){a.error(o),this._onLmsApiInitializationFailed(r)}this._lmsApi&&this._lmsApi.initialize(this._onLmsApiInitialized.bind(this,r),this._onLmsApiInitializationFailed.bind(this,r))}_createLmsApi(r,o,t){}_onLmsApiInitialized(r){let t=x(this._lmsApi).getSuspendData();r(t||void 0).then(m=>this._start(m)),this._closeEventKeys=[E(window,tr.UNLOAD,()=>this._closeLms()),E(window,tr.BEFOREUNLOAD,()=>this._closeLms())]}_onLmsApiInitializationFailed(r){a.error("Lms initialization failed"),r().then(()=>{})}_start(r){this._playerApi=r,this._active=!0,this._startTime=Date.now(),this._sessionStateNotifier.onSessionStart.dispatch(r.getTitle()),r.onClosePlayerRequest.add(()=>{this._closeLms(),d()}),this._longreadGraded=r.isGraded(),this._chaptersCompletionStatuses=r.getCurrentSectionsStateProgress();let o=()=>{this._longreadResult=r.getLongreadResult(),this._updateUserProgress()};r.onPersistedStateChange.add(()=>this._updatePersistedState()),r.onSectionProgressChange.add(()=>{let t=r.getCurrentSectionIndex(),p=r.getCurrentSectionProgress(),m=x(this._lmsApi),f=t>=0&&!this._chaptersCompletionStatuses[t]&&p>=1;f&&(m.setItemViewed(t),this._chaptersCompletionStatuses[t]=!0),o(),f&&this._commit.flush()}),r.onLongreadResultChange.add(()=>o()),r.onQuizStatisticChange.add(()=>{o(),this._commit.flush()}),o()}_createIri(){return`ispring://roll/${encodeURIComponent(this._config.contentId)}`}_closeLms(){if(this._closeEventKeys)for(let o of this._closeEventKeys)y(o);this._active&&(this._active=!1,this._updateDuration(),this._updateUserProgressOnClose()),this._sessionStateNotifier.onSessionEnd.dispatch();let r=x(this._lmsApi);this._suspendEnabled?r.suspend():r.terminate()}_updateUserProgressOnClose(){}_updateUserProgress(){let r=x(this._lmsApi);this._longreadResult&&(this._longreadGraded&&this._longreadResult.score!==null?(r.setScore(this._longreadResult.score,0,100),r.setStatus(this._longreadResult.longreadPassed,this._longreadResult.completed)):r.setStatus(null,this._longreadResult.completed),r.setProgress(this._longreadResult.progress/100),this._commit().catch(o=>a.error(o)))}_updateDuration(){let r=Date.now()-this._startTime;x(this._lmsApi).setLessonDuration(r)}_updatePersistedState(){this._suspendEnabled&&this._playerApi&&this._lmsApi&&this._lmsApi.setSuspendData(this._playerApi.getSuspendData())}};var S=class{constructor(){this._connector=null}createConnector(){}getLearnerPreferences(){return null}initialize(r,o){this._connector=this.createConnector(),this._connector?this._connector.initializeAsync(r,o):o()}commit(){this._getConnector().commit()}suspend(){this._getConnector().terminate(!0),d()}terminate(){this._getConnector().terminate(!1),d()}setSuspendData(r){this._getConnector().setSuspendedData(r)}getSuspendData(){return this._getConnector().getSuspendedData()}setStatus(r,o){this._getConnector().setStatus(r,o)}setScore(r,o,t,p){let m=t-o>0?r/(t-o):0;p!=null&&(r=m*p,t=p),this._getConnector().setScore(r,o,t,m)}setItemViewed(r){}setProgress(r){this._getConnector().setProgress(r)}setLessonDuration(r){this._getConnector().setSessionTime(r)}getUserInfo(){return this._getConnector().getUserInfo()}_getConnector(){if(!this._connector)throw new Error("Connector not created");return this._connector}};var G=class extends S{constructor(r,o){super(),this._reportOptions=r,this._suspendEnabled=o}createConnector(){return new z(this._suspendEnabled)}setStatus(r,o){this._getConnector().setStatus(r,o)}suspend(){super.suspend(),d()}terminate(){super.terminate(),d()}};var Q=class extends S{constructor(r,o=H.SECOND){super(),this._edition=o,this._suspendEnabled=r}createConnector(){return new W(this._edition,this._suspendEnabled)}};function Xr(e){return{apiVersion:e.apiVersion,flags:e.flags,contentId:e.contentId,edition:e.edition}}var A=class e extends h{constructor(r){super(r.apiVersion,r),this._scormConfig=r}static create(r){return new e(Xr(r))}_createLmsApi(r,o,t){switch(r){case"scorm12":return new G(o,t);case"scorm2004":return new Q(t,this._scormConfig.edition)}throw new Error("unknown api version")}};nr("iSpring.roll.LMS.create",A.create);h.prototype.initialize=h.prototype.initializeLms;
